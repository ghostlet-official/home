<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Ghostlet â€” Home</title>
<style>
:root{--glow:#ff6aff}
body{margin:0;font-family:Segoe UI,Arial;background:linear-gradient(180deg,#0d0d1a,#1a1a2e);color:#eee;min-height:100vh;display:flex;flex-direction:column}
.topbar{display:flex;justify-content:space-between;align-items:center;padding:12px 18px;background:#242444;box-shadow:0 0 12px var(--glow);border-bottom:2px solid var(--glow)}
.brand{color:var(--glow);font-weight:800;text-decoration:none}
.container{max-width:1100px;margin:28px auto;padding:0 18px;flex:1}
.hero{background:#17172a;padding:28px;border-radius:12px;box-shadow:0 8px 40px rgba(0,0,0,0.6)}
.btn{background:var(--glow);border:none;color:#fff;padding:10px 14px;border-radius:8px;cursor:pointer;margin-right:8px;font-weight:700}
.small{color:#aaa}
</style>

<!-- Firebase SDKs -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
<!-- shared initializer -->
<script src="/firebase.js"></script>
</head>
<body>
  <div class="topbar">
    <a class="brand" href="index.html">Ghostlet</a>
    <div id="top-controls"></div>
  </div>

  <div class="container">
    <div class="hero">
      <h1 style="color:var(--glow)">Welcome to Ghostlet</h1>
      <p class="small">Open packs, collect blooks, chat with others. Use the navigation below.</p>
      <div style="margin-top:12px">
        <button class="btn" onclick="location.href='market.html'">Market</button>
        <button class="btn" onclick="location.href='blooks.html'">Blooks</button>
        <button class="btn" onclick="location.href='chat.html'">Chat</button>
        <button class="btn" onclick="location.href='stats.html'">Stats</button>
        <button class="btn" onclick="location.href='settings.html'">Settings</button>
      </div>
    </div>
  </div>

<script>
const auth = Ghostlet.auth();
const db = Ghostlet.db();
const controls = document.getElementById('top-controls');

auth.onAuthStateChanged(user=>{
  controls.innerHTML = '';
  if(user){
    const name = user.displayName || user.email || 'Player';
    const btnProfile = document.createElement('button'); btnProfile.className='btn'; btnProfile.textContent=name; btnProfile.onclick=()=> location.href='stats.html';
    const btnSignOut = document.createElement('button'); btnSignOut.className='btn'; btnSignOut.textContent='Sign out'; btnSignOut.onclick=()=> auth.signOut();
    controls.appendChild(btnProfile); controls.appendChild(btnSignOut);
    Ghostlet.ensureUserDoc(user.uid, { username: name }).catch(console.warn);
  } else {
    const login = document.createElement('button'); login.className='btn'; login.textContent='Login'; login.onclick=()=> location.href='login.html';
    const reg = document.createElement('button'); reg.className='btn'; reg.textContent='Register'; reg.onclick=()=> location.href='register.html';
    controls.appendChild(login); controls.appendChild(reg);
  }
});
</script>
</body>
</html>
